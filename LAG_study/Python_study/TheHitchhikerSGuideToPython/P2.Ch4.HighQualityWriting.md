- date: 250630
# P2.Ch4.HighQualityWriting

> briefcut:
> 代碼風格的最佳實踐 幾種許可證的簡介

-----------------------------------------------------------------------------

### 代碼風格概述

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 關於 PEP8

規定了命名約定 代碼結構 使用製表符還是空格

```terminal
# 安裝靜態pep8檢查工具
$ pip install pep8

# 安裝自動格式化文件工具
$ pip install autopep8

# 自動格式化文件 多次使用以獲得更佳效果
$ autopep8 {file}
# --in-place    原地操作 直接修改文件
# --aggressive  進行更多實質性的修改
```

> linter 等靜態檢查工具通常間接使用pep8
> Requests 代碼風格指南(其相比pep8略有修改) http://bit.ly/reitz-code-style

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 關於 PEP20

> - Tim Peter - Timbot - Timsort
> - 其實際上只有19條
> - `PEP20 by Example` by Hunter Blank
> - `Beyond PEP8 : Best Practices for Beautiful , Intelligible Code`
                    by Raymond Hettinger

-----------------------------------------------------------------------------

### 一般性建議

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 明確勝於隱晦

```python
# BAD

def make_dict(*args):
    x , y = args
    return dict( **locals() )

# PYTHONIC

def make_dict( x , y ):
    return { 'x' : x , 'y' : y }
```

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 留白勝於緊湊

```python
# BAD
f1();f2()
if p : f()
" 過於緊湊 "

if <complex comparison1> and <complex comparison2> :
    f()

# PYTHONIC
cond1 = <complex comparison1>
cond2 = <complex comparison2>

if cond1 and cond2 :
    f()
```

> - 留白寫法也利於使用 `diff` 命令分析不同版本差異
> - 這種寫法有時確實會帶來幾毫秒的運行時間差異

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 錯誤不應被默默忽視，除非你明確地忽視

```python
# BAD

try:
    'somecode'
except:
    pass

# PYTHONIC

try:
    'somecode'
except <certain error>:
    pass
except :
    raise
```

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 函數參數使用起來應該符合直覺

- `位置參數`：數量少 能從函數名理解
- `關鍵字參數`：默認值
- `任意數量參數列表`： * 接受同種類型參數時 應使用其他序列結構替代
- `任意數量關鍵字字典`： ** 應用於日誌記錄

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 不假思索就動手還不如不做
> 移除一個‘以防萬一’但從未使用的可選參數及邏輯，通常比新增一個更難

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

#### 如果實現很難解釋，那就不是一個好思路

避免使用如下功能
- 改變對象創建與實例化過程
- 改變導入模塊的過程
- 嵌入C程序

> - 使用最直接了當的方法來實現目標通常是更好的方法
> - 遵循此條以便代碼分析工具更好運作（pylint pyflakes）
> - *真正的Pythonista，就像功夫大師那樣，僅用一根手指就能殺人，但他們從不會那麼做*

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

> *盲目地保持一致是頭腦簡單的表現* quoted from 《自立》（愛迪生） by PEP8
 
-----------------------------------------------------------------------------
